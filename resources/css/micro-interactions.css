@layer components {
    /* Button Interactions */
    .btn {
        @apply transition-all duration-200 ease-in-out transform;
    }
    .btn:hover {
        @apply -translate-y-0.5 shadow-lg;
        transform: translateY(-2px) scale(1.02);
    }
    .btn:active {
        @apply translate-y-0 shadow-md;
        transform: translateY(0) scale(0.98);
    }
    .btn-loading {
        @apply relative;
    }
    .btn-loading::after {
        content: '';
        @apply absolute inset-0 rounded-md bg-white bg-opacity-20 animate-pulse;
    }
    .btn-loading .spinner {
        @apply absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2;
    }

    /* Card Interactions */
    .card { @apply transition-all duration-300 ease-in-out; }
    /* Avoid conflicting with .card-hover:hover from components */
    .card-hover:hover { @apply -translate-y-1 shadow-xl; }
    .card-reveal {
        @apply transition-opacity duration-500 ease-in-out;
    }

    /* Form Input Interactions */
    .form-input {
        @apply transition-all duration-200 ease-in-out will-change-transform;
    }
    .form-input:focus {
        @apply ring-2 ring-primary-500 ring-opacity-50 border-primary-500;
    }
    .form-input-error {
        @apply animate-shake;
    }
    .form-input-success {
        @apply border-green-500 ring-2 ring-green-500 ring-opacity-20;
    }

    /* Navigation Interactions */
    .nav-link {
        @apply relative after:absolute after:bottom-0 after:left-0 after:h-0.5 after:w-0 after:bg-primary-500 after:transition-all after:duration-300;
    }
    .nav-link:hover::after,
    .nav-link-active::after {
        @apply w-full;
    }
    .dropdown-enter { @apply transition ease-out duration-100; }
    .dropdown-enter-from { @apply transform opacity-0 scale-95; }
    .dropdown-enter-to { @apply transform opacity-100 scale-100; }
    .dropdown-leave { @apply transition ease-in duration-75; }
    .dropdown-leave-from { @apply transform opacity-100 scale-100; }
    .dropdown-leave-to { @apply transform opacity-0 scale-95; }

    /* Task Interactions */
    .task-complete-animation {
        @apply transition-all duration-500 ease-in-out;
    }
    .task-complete-animation.completed {
        @apply opacity-50 line-through;
    }
    .task-drag-feedback {
        @apply bg-primary-100 dark:bg-primary-900/50 rounded-lg shadow-lg;
    }

    /* Theme Transition */
    .theme-transition {
        @apply transition-colors duration-300;
    }
    .theme-toggle-icon {
        @apply transition-transform duration-500 ease-in-out;
    }
    .dark .theme-toggle-icon {
        @apply rotate-180;
    }

    /* Loading & Progress Animations */
    .skeleton-loader {
        @apply animate-pulse bg-gray-200 dark:bg-gray-700 rounded-md;
    }
    .spinner {
        @apply w-5 h-5 border-2 border-t-transparent border-white rounded-full animate-spin;
    }

    /* Notification Animations */
    .toast-enter { @apply transition-all duration-300 ease-out; }
    .toast-enter-from { @apply opacity-0 transform translate-y-4 sm:translate-y-0 sm:translate-x-4; }
    .toast-enter-to { @apply opacity-100 transform translate-y-0 sm:translate-x-0; }
    .toast-leave { @apply transition-all duration-300 ease-in; }
    .toast-leave-from { @apply opacity-100; }
    .toast-leave-to { @apply opacity-0; }

    @keyframes shake {
        10%, 90% { transform: translate3d(-1px, 0, 0); }
        20%, 80% { transform: translate3d(1px, 0, 0); }
        30%, 50%, 70% { transform: translate3d(-2px, 0, 0); }
        40%, 60% { transform: translate3d(2px, 0, 0); }
    }
    .animate-shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }

        /* Enhanced Button Interactions */
        .btn-magnetic { transition: transform var(--transition-base) ease; will-change: transform; }
        .btn-success-anim { position: relative; }
        .btn-success-anim::after { content: "\2713"; position: absolute; right: 0.5rem; opacity: 0; transform: translateY(-4px); transition: opacity var(--transition-fast), transform var(--transition-fast); }
        .btn-success-anim.is-success::after { opacity: 1; transform: translateY(0); }
        .btn-error-anim::after { content: "\2715"; position: absolute; right: 0.5rem; opacity: 0; transform: translateY(-4px); transition: opacity var(--transition-fast), transform var(--transition-fast); }
        .btn-error-anim.is-error::after { opacity: 1; transform: translateY(0); }

        /* .btn-ripple-effect now purely aliases .btn-ripple via combined selectors in components.css */

        @keyframes ripple {
            from { width: 0; height: 0; opacity: 0.7; }
            to { width: 220%; height: 220%; opacity: 0; }
        }

        /* Card Enhancements */
        .card-tilt { transform-style: preserve-3d; transition: transform var(--transition-base) ease; }
        .card-reveal.fade-up { animation: fadeInUp 500ms ease both; }
        .card-reveal.fade-down { animation: fadeInDown 500ms ease both; }
        .card-reveal.fade-left { animation: fadeInLeft 500ms ease both; }
        .card-reveal.fade-right { animation: fadeInRight 500ms ease both; }
        .card-stagger-item { opacity: 0; transform: translateY(8px); }
        .card-stagger-item.is-inview { animation: fadeInUp 600ms ease forwards; }
        .card-parallax { background-attachment: fixed; }

        /* Form Input Interactions */
        .char-counter { @apply text-xs text-gray-400 mt-1; transition: color var(--transition-fast); }
        .char-counter.warning { @apply text-yellow-500; }
        .char-counter.error { @apply text-red-500; }
        .password-strength { height: 6px; border-radius: var(--radius-full); background: linear-gradient(90deg, var(--color-error-500), var(--color-warning-500), var(--color-success-500)); width: 0; transition: width var(--transition-base) ease; }
        .autocomplete-menu { @apply mt-1 max-h-60 overflow-auto rounded-md border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-lg transition-transform duration-200 origin-top; transform: scaleY(0.95); opacity: 0; }
        .autocomplete-menu.open { transform: scaleY(1); opacity: 1; }
        .form-input-error { animation: shake 0.6s cubic-bezier(.36,.07,.19,.97) both; }

        /* Navigation Enhancements */
        .nav-underline { position: relative; }
        .nav-underline::after { content: ""; position: absolute; left: 0; bottom: -2px; height: 2px; width: 0; background: linear-gradient(90deg, var(--color-primary-500), var(--color-accent-500)); transition: width var(--transition-base); }
        .nav-underline:hover::after, .nav-underline.is-active::after { width: 100%; }
        .menu-stagger > * { opacity: 0; transform: translateY(6px); }
        .menu-stagger > *.in { animation: fadeInUp 400ms ease forwards; }
        .mobile-menu { transform: translateX(100%); transition: transform var(--transition-slow) ease; }
        .mobile-menu.open { transform: translateX(0); }
        .breadcrumb-item { opacity: 0; transform: translateX(-6px); }
        .breadcrumb-item.in { animation: fadeInRight 400ms ease forwards; }

        /* Page Transitions */
        .page-enter { animation: fadeInUp 420ms ease both; }
        .page-leave { animation: fadeOut 320ms ease both; }
        .fade-in-up { animation: fadeInUp 500ms ease both; }
        .fade-in-down { animation: fadeInDown 500ms ease both; }
        .fade-in-left { animation: fadeInLeft 500ms ease both; }
        .fade-in-right { animation: fadeInRight 500ms ease both; }
        .scale-in { animation: scaleIn 300ms ease both; }
        .scale-out { animation: scaleOut 300ms ease both; }
        .rotate-in { animation: rotateIn 400ms ease both; }

        /* Scroll-based */
        .scroll-reveal { opacity: 0; transform: translateY(8px); }
        .scroll-reveal.in { animation: fadeInUp 600ms ease forwards; }
        .parallax-slow { transform: translateY(var(--parallax-offset, 0)); }
        .parallax-fast { transform: translateY(calc(var(--parallax-offset, 0) * 1.5)); }
        .sticky-reveal { position: sticky; top: 0; -webkit-backdrop-filter: blur(6px); backdrop-filter: blur(6px); transition: background var(--transition-base), box-shadow var(--transition-base); }
        .sticky-reveal.scrolled { background: rgba(255,255,255,0.6); box-shadow: var(--shadow); }
        :root.dark .sticky-reveal.scrolled { background: rgba(17,24,39,0.5); }

        /* Loading */
        .skeleton-loader.shimmer { position: relative; overflow: hidden; }
        .skeleton-loader.shimmer::after { content: ""; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.35), transparent); transform: translateX(-100%); animation: shimmer 1.5s infinite; }
        .pulse-slow { animation: pulse 3s cubic-bezier(0.4,0,0.6,1) infinite; }
        .pulse-fast { animation: pulse 1s cubic-bezier(0.4,0,0.6,1) infinite; }
    .loading-dots { display: inline-flex; gap: 3px; }
    .loading-dots > span { width: 5px; height: 5px; border-radius: 9999px; background: currentColor; opacity: 0.35; animation: dotBlink 1.1s infinite ease-in-out; }
    .loading-dots > span:nth-child(2){ animation-delay: .15s }
    .loading-dots > span:nth-child(3){ animation-delay: .3s }
    @keyframes dotBlink { 0%,80%,100%{opacity:.35} 40%{opacity:1} }
        .spinner-dual { width: 1.5rem; height: 1.5rem; border: 3px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 9999px; animation: spin 1s linear infinite; position: relative; }
        .spinner-dual::after { content: ""; position: absolute; inset: 3px; border: 3px solid rgba(255,255,255,0.3); border-bottom-color: #fff; border-radius: 9999px; animation: spin 1s linear infinite reverse; }
        .spinner-orbit { position: relative; width: 1.5rem; height: 1.5rem; }
        .spinner-orbit::before, .spinner-orbit::after { content: ""; position: absolute; inset: 0; border: 2px dashed rgba(255,255,255,0.4); border-radius: 9999px; animation: spin 2s linear infinite; }
        .spinner-orbit::after { animation-duration: 3s; }

        /* Toast/Notification variants */
        .toast-bounce-in { animation: bounceIn 600ms ease both; }
        .toast-slide-left { animation: slideInLeft 400ms ease both; }
        .toast-slide-right { animation: slideInRight 400ms ease both; }
        .toast-progress { position: absolute; left: 0; bottom: 0; height: 3px; width: 100%; background: linear-gradient(90deg, var(--color-primary-500), var(--color-accent-500)); transform-origin: left; animation: toastProgress 4s linear forwards; }

        /* Fun interactions */
        .bounce-in { animation: bounceIn 600ms ease both; }
        .wiggle { animation: wiggle 1s ease-in-out infinite; }
        .heartbeat { animation: heartbeat 1.3s ease-in-out infinite; }
        .flip { animation: flip 600ms ease both; transform-style: preserve-3d; }
        .swing { animation: swing 1.2s ease-in-out infinite; transform-origin: top center; }

        /* Accessibility */
        .focus-ring-animated { transition: box-shadow var(--transition-fast); }
        .focus-ring-animated:focus-visible { box-shadow: 0 0 0 4px rgba(var(--color-primary-500-rgb) / 0.25), var(--shadow-glow); }
        .skip-to-content { position: absolute; left: -9999px; top: 0; background: var(--color-primary-600); color: #fff; padding: 0.5rem 1rem; border-radius: var(--radius-md); transition: left var(--transition-fast); z-index: var(--z-tooltip); }
        .skip-to-content:focus { left: 0.5rem; }
        .kbd-nav { outline: 2px dashed var(--color-accent-500); outline-offset: 2px; }

        /* Keyframes */
        @keyframes shimmer { 100% { transform: translateX(100%); } }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 0 rgba(0,0,0,0); } 50% { box-shadow: 0 0 24px rgb(var(--color-primary-500-rgb) / 0.35); } }
        @keyframes gradient-shift { 0%,100% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
        @keyframes slideUp { from { transform: translateY(10%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes slideDown { from { transform: translateY(-10%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-8px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInLeft { from { opacity: 0; transform: translateX(-8px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes fadeInRight { from { opacity: 0; transform: translateX(8px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes scaleIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }
        @keyframes scaleOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(0.98); } }
        @keyframes rotateIn { from { opacity: 0; transform: rotate(-8deg) scale(0.98); } to { opacity: 1; transform: rotate(0) scale(1); } }
        /* Removed content animation for better cross-browser behavior. */
        @keyframes toastProgress { from { transform: scaleX(1); } to { transform: scaleX(0); } }
        @keyframes bounceIn { 0% { opacity: 0; transform: scale(0.9); } 60% { opacity: 1; transform: scale(1.02); } 100% { transform: scale(1); } }
        @keyframes wiggle { 0%, 100% { transform: rotate(-3deg); } 50% { transform: rotate(3deg); } }
        @keyframes heartbeat { 0%, 100% { transform: scale(1); } 14% { transform: scale(1.15); } 28% { transform: scale(1); } 42% { transform: scale(1.15); } 70% { transform: scale(1); } }
        @keyframes flip { from { transform: rotateY(-180deg); } to { transform: rotateY(0); } }
        @keyframes swing { 0% { transform: rotate(3deg); } 50% { transform: rotate(-3deg); } 100% { transform: rotate(3deg); } }

        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            .btn, .card, .toast-enter, .toast-leave, [class*="fade-"], [class*="slide-"], .wiggle, .heartbeat, .flip, .swing { animation: none !important; transition: none !important; }
        }
}
